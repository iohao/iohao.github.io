"use strict";(self.webpackChunkionet_doc=self.webpackChunkionet_doc||[]).push([[9803],{316:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>r});const o=JSON.parse('{"id":"manual/flow_context_attachment","title":"\u5143\u4fe1\u606f-\u9644\u52a0\u4fe1\u606f","description":"\u4ecb\u7ecd","source":"@site/docs/manual/flow_context_attachment.mdx","sourceDirName":"manual","slug":"/manual/flow_context_attachment","permalink":"/ionet/docs/manual/flow_context_attachment","draft":false,"unlisted":false,"editUrl":"/docs/manual/flow_context_attachment.mdx","tags":[],"version":"current","lastUpdatedAt":1762049819000,"sidebarPosition":128,"frontMatter":{"sidebar_position":128},"sidebar":"tutorialSidebar","previous":{"title":"FlowContext","permalink":"/ionet/docs/manual/flow_context"},"next":{"title":"Runner \u6269\u5c55\u673a\u5236","permalink":"/ionet/docs/manual/runner"}}');var c=e(4848),a=e(8453);const l={sidebar_position:128},i="\u5143\u4fe1\u606f-\u9644\u52a0\u4fe1\u606f",s={},r=[{value:"\u4ecb\u7ecd",id:"Intro",level:2},{value:"Example Source Code",id:"example-source-code",level:2},{value:"\u5982\u4f55\u4f7f\u7528",id:"How-to-Use",level:2},{value:"\u914d\u5408\u81ea\u5b9a\u4e49 FlowContext",id:"Coordination-FlowContext",level:2}];function h(t){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...t.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"\u5143\u4fe1\u606f-\u9644\u52a0\u4fe1\u606f",children:"\u5143\u4fe1\u606f-\u9644\u52a0\u4fe1\u606f"})}),"\n",(0,c.jsx)(n.h2,{id:"Intro",children:"\u4ecb\u7ecd"}),"\n",(0,c.jsx)(n.p,{children:"\u5728\u5904\u7406 action \u65f6\uff0c\u901a\u8fc7 FlowContext \u53ef\u4ee5\u65b9\u4fbf\u5f97\u5230\u5f53\u524d userId\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u5f00\u53d1\u8005\u60f3\u5728\u5904\u7406 action \u65f6\uff0c\u643a\u5e26\u4e0a\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5143\u9644\u52a0\u4fe1\u606f\u7279\u6027\u6765\u5b8c\u6210\u3002\n\u5c06\u4e00\u4e9b\u81ea\u5b9a\u4e49\u4fe1\u606f\u4fdd\u5b58\u5230\u5143\u9644\u52a0\u4fe1\u606f\u540e\uff0c\u4e4b\u540e\u7684\u6bcf\u4e2a action \u8bf7\u6c42\u53ef\u4ee5\u901a\u8fc7 FlowContext \u6765\u5f97\u5230\u8fd9\u4e9b\u81ea\u5b9a\u4e49\u4fe1\u606f\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u6bd4\u5982\u4fdd\u5b58\u5f53\u524d\u73a9\u5bb6\u7684\u82f1\u96c4\u89d2\u8272\u4fe1\u606f\u3001\u73a9\u5bb6\u6635\u79f0\uff0c\u53c8\u6216\u8005\u662f\u4f60\u7684\u9879\u76ee\u7684 userId \u662f string \u6216\u5176\u4ed6\u7c7b\u578b\u5219\u53ef\u4ee5\u901a\u8fc7\u5143\u4fe1\u606f\u8fd9\u4e00\u7279\u6027\u6765\u517c\u5bb9\u3002\n\u7b80\u5355\u7684\u8bf4\uff0c\u5c31\u662f\u4f60\u60f3\u5728 FlowContext \u4e2d\u83b7\u53d6\u4e00\u4e9b\u73a9\u5bb6\u7279\u6709\u7684\u4fe1\u606f\u6570\u636e\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u7279\u6027\u6765\u5b9e\u73b0\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"example-source-code",children:"Example Source Code"}),"\n",(0,c.jsxs)(n.p,{children:["see ",(0,c.jsx)(n.a,{href:"https://github.com/iohao/ionet-examples",children:"https://github.com/iohao/ionet-examples"})]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"path : ionet-cookbook-code"}),"\n"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"AttachmentAction"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"How-to-Use",children:"\u5982\u4f55\u4f7f\u7528"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u81ea\u5b9a\u4e49\u5143\u4fe1\u606f\u7c7b"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-java",children:"@ProtobufClass\npublic class MyAttachment {\n    public long userId;\n    public String nickname;\n}\n"})}),"\n",(0,c.jsx)("br",{}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u66f4\u65b0\u5143\u4fe1\u606f"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"code 10~11\uff0c\u8bbe\u7f6e\u5e76\u540c\u6b65\u66f4\u65b0\u5143\u4fe1\u606f\u3002"}),"\n",(0,c.jsx)(n.li,{children:"code 20\uff0c\u83b7\u53d6\u5143\u4fe1\u606f\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-java",metastring:"showLineNumbers",children:'@ActionController(AttachmentCmd.cmd)\npublic class AttachmentAction {\n    @ActionMethod(AttachmentCmd.updateAttachment)\n    private boolean updateAttachment(MyFlowContext flowContext) {\n        var attachment = new MyAttachment();\n        attachment.userId = flowContext.getUserId();\n        attachment.nickname = "Michael Jackson";\n\n        // set and update attachment\n        // highlight-next-line\n        flowContext.setAttachment(attachment);\n        // highlight-next-line\n        flowContext.updateAttachment();\n        // Async update\n        // flowContext.updateAttachmentAsync();\n\n        return true;\n    }\n\n    @ActionMethod(AttachmentCmd.printAttachment)\n    private String printAttachment(FlowContext flowContext) {\n        // highlight-next-line\n        MyAttachment attachment = flowContext.getAttachment();\n        return attachment.toString();\n    }\n}\n'})}),"\n",(0,c.jsx)(n.h2,{id:"Coordination-FlowContext",children:"\u914d\u5408\u81ea\u5b9a\u4e49 FlowContext"}),"\n",(0,c.jsxs)(n.p,{children:["\u6211\u4eec\u53ef\u4ee5\u914d\u5408",(0,c.jsx)(n.a,{href:"/docs/manual/flow_context#custom_flowcontext",children:"\u81ea\u5b9a\u4e49 FlowContext"})," \u7279\u6027 \uff0c\u505a\u4e00\u4e9b\u66f4\u7b26\u5408\u5b9a\u5236\u7684\u6269\u5c55\uff0c\u5982\u4e0b\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["code 5\uff0c\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"MyFlowContext.getNickname()"})," \u65b9\u6cd5"]}),"\n",(0,c.jsx)(n.li,{children:"code 10\uff0c\u81ea\u5b9a\u4e49 MyFlowContext\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8be5\u7c7b\u4e2d\u6dfb\u52a0\u4efb\u610f\u7684\u4fbf\u6377\u65b9\u6cd5\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-java",metastring:"showLineNumbers",children:"@ActionController(1)\npublic class DemoAction {\n    @ActionMethod(1)\n    public String getNickname(MyFlowContext flowContext) {\n        // highlight-next-line\n        return flowContext.getNickname();\n    }\n}\n\n@Setter\n// highlight-next-line\npublic class MyFlowContext extends DefaultFlowContext {\n    MyAttachment attachment;\n\n    @Override\n    public MyAttachment getAttachment() {\n        if (Objects.isNull(this.attachment)) {\n            this.attachment = this.getAttachment(MyAttachment.class);\n        }\n\n        return this.attachment;\n    }\n\n    public String getNickname() {\n        MyAttachment attachment = this.getAttachment();\n        return attachment.nickname;\n    }\n}\n"})})]})}function d(t={}){const{wrapper:n}={...(0,a.R)(),...t.components};return n?(0,c.jsx)(n,{...t,children:(0,c.jsx)(h,{...t})}):h(t)}},8453:(t,n,e)=>{e.d(n,{R:()=>l,x:()=>i});var o=e(6540);const c={},a=o.createContext(c);function l(t){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function i(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(c):t.components||c:l(t.components),o.createElement(a.Provider,{value:n},t.children)}}}]);